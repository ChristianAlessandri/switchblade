# Matugen Configuration & Templates üé®

This folder contains the configuration engine for **Switchblade**. It uses [Matugen](https://github.com/InioX/matugen) to generate color schemes from your wallpaper and apply them to various applications instantly.

## üìÇ Structure

- **`config.toml`**: The main configuration file.
- **`templates/`**: The "blueprints" used to generate color files for your apps.

---

## üöÄ Setup Guide

### 1. Configure `config.toml`

Move the config file to your user directory:

```bash
   mkdir -p ~/.config/matugen
   cp config.toml ~/.config/matugen/
   cp -r templates ~/.config/matugen/
```

Now open `~/.config/matugen/config.toml`:

1. Check Paths: You can use ~ for output_path (e.g., ~/.config/waybar/colors.css), which works for everyone.
2. SDDM Hook: For the SDDM command, you must use absolute paths (see the Sudoers section below).

### 2. Grant Permissions (Sudoers) üîê

To update the SDDM login screen, the script needs root permissions to copy the file. Since `sudo` cannot read `~` or `$USER` in config files reliably, you must set this up manually.

Create a rule file:

```bash
sudo visudo -f /etc/sudoers.d/matugen-sddm
```

Paste this line (replace `YOUR_USERNAME` with your actual username):

```plaintext
YOUR_USERNAME ALL=(root) NOPASSWD: /usr/bin/cp /home/YOUR_USERNAME/.cache/Colors.qml /usr/share/sddm/themes/sugar-candy/Colors.qml
```

_(Make sure the theme name sugar-candy matches the one you are using)._

---

### üîó 3. App Integration (Crucial!)

**Matugen is not magic.** It generates color files, but your applications won't use them unless you modify their config files to import them.

For a comprehensive guide on how to configure each app, check the official repo: üëâ [Matugen Themes Integration Guide](https://github.com/InioX/matugen-themes)

**Quick Examples**:
**Waybar** (`~/.config/waybar/style.css`): Add this line at the top:

```css
@import "colors.css";
```

**Kitty** (`~/.config/kitty/kitty.conf`): Add this line:

```config
include colors.conf
```

**Hyprland** (`~/.config/hypr/hyprland.conf`): Add this line:

```toml
source = ~/.config/hypr/colors.conf
```

## ‚ö†Ô∏è Special Note on SDDM (Login Screen)

Since SDDM runs as a separate user, it needs specific configurations to work with Switchblade.

### 1. Syncing the Wallpaper üñºÔ∏è

The script copies your chosen wallpaper to the theme folder and renames it to `current.jpg`.
You must configure your installed theme to always look for this specific file.

Open your theme's config file (usually `/usr/share/sddm/themes/YOUR_THEME_NAME/theme.conf`) and ensure the Background line looks exactly like this:

```ini
[General]
Background="./current.jpg"
```

_If you don't do this, the login screen wallpaper will not change when you run the script._

### 2. Syncing the Colors üé®

Your theme needs to import the `Colors.qml` file generated by this script.

**This is not supported by default themes.** You generally need to patch your `Main.qml`:

1. Ensure the `config.toml` defines the correct path for `Colors.qml` in the `[templates.sddm]` section.
2. Add the permissions via `sudoers` (as explained in the Setup section above).
3. Modify your theme's `Main.qml` to import the colors.

**Example `Main.qml` patch**:

```qml
// Import the component
import "Components"

Pane {
    // Instantiate the colors object
    Colors { id: matugen }

    // Use the colors (Example)
    palette.highlight: matugen.primary
    palette.window: matugen.surface
}
```

## ‚ùì Troubleshooting

- **"Permission denied" on SDDM**: Check your `sudoers` file for typos. Ensure you used the full path `/home/YOUR_USERNAME/....`
- **Apps not changing color**: Did you add the `@import` or `include` line in the app's config file? (See Step 3).
- **Matugen error "File not found"**: Ensure the destination folder exists. Matugen creates files, but not folders.
